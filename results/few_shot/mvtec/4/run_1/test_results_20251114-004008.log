2025-11-14 00:40:08,762 - INFO - [Logger] writing to ./results/few_shot/4/run_1/test_results_20251114-004008.log
2025-11-14 00:40:08,763 - INFO - [Args] {'clip_download_dir': './download/clip/', 'data_dir': './data', 'dataset': 'visa', 'model': 'ViT-L/14@336px', 'batch_size': 8, 'img_size': 518, 'test_dataset': ['mvtec'], 'weight': './weight/best_maxf1_visa.pt', 'load_strict': False, 'device': 'cuda:0', 'prompt_len': 12, 'fewshot': 4, 'vis': 0, 'vis_dir': './vis', 'alpha': 0.1, 'memory_layers': [6, 12, 18, 24], 'adapter_layers': -1, 'result_dir': './results/few_shot/4/run_1', 'log_file': ''}
2025-11-14 00:40:09,110 - INFO - --------------------------- mvtec ---------------------------
2025-11-14 00:40:09,114 - INFO - carpet, ['./data/mvtec/carpet/train/good/088.png', './data/mvtec/carpet/train/good/199.png', './data/mvtec/carpet/train/good/257.png', './data/mvtec/carpet/train/good/039.png']
2025-11-14 00:42:35,223 - INFO - Category carpet: Sample_CLS_AUROC: 99.959872 Sample_CLS_AP: 99.987516 Sample_CLS_max-F1: 99.441341 Pixel_AUROC: 99.266937 Pixel_AP: 77.897747 Pixel_max-F1: 72.886748 Pixel_PRO: 97.872567 
2025-11-14 00:42:35,224 - INFO - grid, ['./data/mvtec/grid/train/good/206.png', './data/mvtec/grid/train/good/218.png', './data/mvtec/grid/train/good/003.png', './data/mvtec/grid/train/good/018.png']
2025-11-14 00:44:10,239 - INFO - Category grid: Sample_CLS_AUROC: 97.410192 Sample_CLS_AP: 99.146289 Sample_CLS_max-F1: 96.428571 Pixel_AUROC: 98.055259 Pixel_AP: 44.489837 Pixel_max-F1: 47.212694 Pixel_PRO: 94.076852 
2025-11-14 00:44:10,240 - INFO - leather, ['./data/mvtec/leather/train/good/017.png', './data/mvtec/leather/train/good/184.png', './data/mvtec/leather/train/good/065.png', './data/mvtec/leather/train/good/124.png']
2025-11-14 00:46:39,277 - INFO - Category leather: Sample_CLS_AUROC: 100.000000 Sample_CLS_AP: 100.000000 Sample_CLS_max-F1: 100.000000 Pixel_AUROC: 99.526032 Pixel_AP: 56.662000 Pixel_max-F1: 55.325912 Pixel_PRO: 98.927067 
2025-11-14 00:46:39,278 - INFO - tile, ['./data/mvtec/tile/train/good/127.png', './data/mvtec/tile/train/good/224.png', './data/mvtec/tile/train/good/029.png', './data/mvtec/tile/train/good/065.png']
2025-11-14 00:49:20,501 - INFO - Category tile: Sample_CLS_AUROC: 99.891775 Sample_CLS_AP: 99.957479 Sample_CLS_max-F1: 99.408284 Pixel_AUROC: 97.045236 Pixel_AP: 76.758399 Pixel_max-F1: 73.008762 Pixel_PRO: 94.467561 
2025-11-14 00:49:20,501 - INFO - wood, ['./data/mvtec/wood/train/good/138.png', './data/mvtec/wood/train/good/144.png', './data/mvtec/wood/train/good/122.png', './data/mvtec/wood/train/good/233.png']
2025-11-14 00:51:04,206 - INFO - Category wood: Sample_CLS_AUROC: 100.000000 Sample_CLS_AP: 100.000000 Sample_CLS_max-F1: 100.000000 Pixel_AUROC: 96.760018 Pixel_AP: 71.821060 Pixel_max-F1: 67.895303 Pixel_PRO: 96.499567 
2025-11-14 00:51:04,206 - INFO - bottle, ['./data/mvtec/bottle/train/good/124.png', './data/mvtec/bottle/train/good/027.png', './data/mvtec/bottle/train/good/065.png', './data/mvtec/bottle/train/good/092.png']
2025-11-14 00:52:52,885 - INFO - Category bottle: Sample_CLS_AUROC: 99.920635 Sample_CLS_AP: 99.975198 Sample_CLS_max-F1: 99.212598 Pixel_AUROC: 97.168668 Pixel_AP: 79.800047 Pixel_max-F1: 74.602749 Pixel_PRO: 94.334239 
2025-11-14 00:52:52,885 - INFO - cable, ['./data/mvtec/cable/train/good/137.png', './data/mvtec/cable/train/good/215.png', './data/mvtec/cable/train/good/053.png', './data/mvtec/cable/train/good/114.png']
2025-11-14 00:56:03,172 - INFO - Category cable: Sample_CLS_AUROC: 88.099700 Sample_CLS_AP: 92.873198 Sample_CLS_max-F1: 86.486486 Pixel_AUROC: 93.334299 Pixel_AP: 49.141310 Pixel_max-F1: 50.611984 Pixel_PRO: 87.036259 
2025-11-14 00:56:03,172 - INFO - capsule, ['./data/mvtec/capsule/train/good/113.png', './data/mvtec/capsule/train/good/132.png', './data/mvtec/capsule/train/good/179.png', './data/mvtec/capsule/train/good/092.png']
2025-11-14 00:58:42,074 - INFO - Category capsule: Sample_CLS_AUROC: 95.013961 Sample_CLS_AP: 98.812251 Sample_CLS_max-F1: 96.860987 Pixel_AUROC: 98.541550 Pixel_AP: 48.096682 Pixel_max-F1: 47.160545 Pixel_PRO: 97.486887 
2025-11-14 00:58:42,075 - INFO - hazelnut, ['./data/mvtec/hazelnut/train/good/317.png', './data/mvtec/hazelnut/train/good/265.png', './data/mvtec/hazelnut/train/good/132.png', './data/mvtec/hazelnut/train/good/053.png']
2025-11-14 01:00:59,154 - INFO - Category hazelnut: Sample_CLS_AUROC: 100.000000 Sample_CLS_AP: 100.000000 Sample_CLS_max-F1: 100.000000 Pixel_AUROC: 98.877161 Pixel_AP: 70.078171 Pixel_max-F1: 69.819061 Pixel_PRO: 97.237027 
2025-11-14 01:00:59,155 - INFO - metal_nut, ['./data/mvtec/metal_nut/train/good/113.png', './data/mvtec/metal_nut/train/good/020.png', './data/mvtec/metal_nut/train/good/098.png', './data/mvtec/metal_nut/train/good/166.png']
2025-11-14 01:03:46,417 - INFO - Category metal_nut: Sample_CLS_AUROC: 100.000000 Sample_CLS_AP: 100.000000 Sample_CLS_max-F1: 100.000000 Pixel_AUROC: 93.615977 Pixel_AP: 68.262918 Pixel_max-F1: 65.733135 Pixel_PRO: 92.996930 
2025-11-14 01:03:46,418 - INFO - pill, ['./data/mvtec/pill/train/good/141.png', './data/mvtec/pill/train/good/064.png', './data/mvtec/pill/train/good/160.png', './data/mvtec/pill/train/good/152.png']
2025-11-14 01:07:16,355 - INFO - Category pill: Sample_CLS_AUROC: 97.654119 Sample_CLS_AP: 99.555773 Sample_CLS_max-F1: 96.551724 Pixel_AUROC: 94.767679 Pixel_AP: 57.541683 Pixel_max-F1: 59.464106 Pixel_PRO: 97.186473 
2025-11-14 01:07:16,355 - INFO - screw, ['./data/mvtec/screw/train/good/304.png', './data/mvtec/screw/train/good/163.png', './data/mvtec/screw/train/good/006.png', './data/mvtec/screw/train/good/214.png']
2025-11-14 01:10:24,591 - INFO - Category screw: Sample_CLS_AUROC: 79.995901 Sample_CLS_AP: 91.179440 Sample_CLS_max-F1: 88.030888 Pixel_AUROC: 97.830891 Pixel_AP: 23.854294 Pixel_max-F1: 27.995654 Pixel_PRO: 92.069145 
2025-11-14 01:10:24,592 - INFO - toothbrush, ['./data/mvtec/toothbrush/train/good/010.png', './data/mvtec/toothbrush/train/good/026.png', './data/mvtec/toothbrush/train/good/034.png', './data/mvtec/toothbrush/train/good/004.png']
2025-11-14 01:11:16,405 - INFO - Category toothbrush: Sample_CLS_AUROC: 93.611111 Sample_CLS_AP: 97.128693 Sample_CLS_max-F1: 95.238095 Pixel_AUROC: 99.290622 Pixel_AP: 69.083313 Pixel_max-F1: 69.550595 Pixel_PRO: 95.005262 
2025-11-14 01:11:16,405 - INFO - transistor, ['./data/mvtec/transistor/train/good/150.png', './data/mvtec/transistor/train/good/086.png', './data/mvtec/transistor/train/good/026.png', './data/mvtec/transistor/train/good/027.png']
2025-11-14 01:13:28,232 - INFO - Category transistor: Sample_CLS_AUROC: 93.750000 Sample_CLS_AP: 92.448927 Sample_CLS_max-F1: 84.931507 Pixel_AUROC: 83.429314 Pixel_AP: 33.933630 Pixel_max-F1: 36.290320 Pixel_PRO: 65.602164 
2025-11-14 01:13:28,233 - INFO - zipper, ['./data/mvtec/zipper/train/good/124.png', './data/mvtec/zipper/train/good/023.png', './data/mvtec/zipper/train/good/171.png', './data/mvtec/zipper/train/good/108.png']
2025-11-14 01:16:32,295 - INFO - Category zipper: Sample_CLS_AUROC: 98.398109 Sample_CLS_AP: 99.574634 Sample_CLS_max-F1: 97.119342 Pixel_AUROC: 98.660131 Pixel_AP: 73.582916 Pixel_max-F1: 69.932090 Pixel_PRO: 95.511240 
2025-11-14 01:16:32,295 - INFO - Average: Sample_CLS_AUROC: 96.247025 Sample_CLS_AP: 98.042627 Sample_CLS_max-F1: 95.980655 Pixel_AUROC: 96.411318 Pixel_AP: 60.066934 Pixel_max-F1: 59.165977 Pixel_PRO: 93.087283 
2025-11-14 01:16:32,296 - INFO - --------------------------------------------------------------------
2025-11-14 01:16:32,296 - INFO - [Summary]
2025-11-14 01:16:32,296 - INFO - mvtec: value=Sample_CLS_AUROC: 96.247025 Sample_CLS_AP: 98.042627 Sample_CLS_max-F1: 95.980655 Pixel_AUROC: 96.411318 Pixel_AP: 60.066934 Pixel_max-F1: 59.165977 Pixel_PRO: 93.087283 
