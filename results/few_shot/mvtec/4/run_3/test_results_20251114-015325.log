2025-11-14 01:53:25,967 - INFO - [Logger] writing to ./results/few_shot/4/run_3/test_results_20251114-015325.log
2025-11-14 01:53:25,967 - INFO - [Args] {'clip_download_dir': './download/clip/', 'data_dir': './data', 'dataset': 'visa', 'model': 'ViT-L/14@336px', 'batch_size': 8, 'img_size': 518, 'test_dataset': ['mvtec'], 'weight': './weight/best_maxf1_visa.pt', 'load_strict': False, 'device': 'cuda:0', 'prompt_len': 12, 'fewshot': 4, 'vis': 0, 'vis_dir': './vis', 'alpha': 0.1, 'memory_layers': [6, 12, 18, 24], 'adapter_layers': -1, 'result_dir': './results/few_shot/4/run_3', 'log_file': ''}
2025-11-14 01:53:26,313 - INFO - --------------------------- mvtec ---------------------------
2025-11-14 01:53:26,318 - INFO - carpet, ['./data/mvtec/carpet/train/good/251.png', './data/mvtec/carpet/train/good/107.png', './data/mvtec/carpet/train/good/161.png', './data/mvtec/carpet/train/good/198.png']
2025-11-14 01:55:53,115 - INFO - Category carpet: Sample_CLS_AUROC: 100.000000 Sample_CLS_AP: 100.000000 Sample_CLS_max-F1: 100.000000 Pixel_AUROC: 99.277723 Pixel_AP: 78.251899 Pixel_max-F1: 73.014648 Pixel_PRO: 97.755770 
2025-11-14 01:55:53,116 - INFO - grid, ['./data/mvtec/grid/train/good/032.png', './data/mvtec/grid/train/good/159.png', './data/mvtec/grid/train/good/146.png', './data/mvtec/grid/train/good/092.png']
2025-11-14 01:57:27,679 - INFO - Category grid: Sample_CLS_AUROC: 98.412698 Sample_CLS_AP: 99.455007 Sample_CLS_max-F1: 96.428571 Pixel_AUROC: 97.711178 Pixel_AP: 43.603417 Pixel_max-F1: 47.654857 Pixel_PRO: 93.194700 
2025-11-14 01:57:27,680 - INFO - leather, ['./data/mvtec/leather/train/good/215.png', './data/mvtec/leather/train/good/031.png', './data/mvtec/leather/train/good/082.png', './data/mvtec/leather/train/good/076.png']
2025-11-14 01:59:56,796 - INFO - Category leather: Sample_CLS_AUROC: 100.000000 Sample_CLS_AP: 100.000000 Sample_CLS_max-F1: 100.000000 Pixel_AUROC: 99.514243 Pixel_AP: 54.463846 Pixel_max-F1: 54.216709 Pixel_PRO: 98.663611 
2025-11-14 01:59:56,797 - INFO - tile, ['./data/mvtec/tile/train/good/163.png', './data/mvtec/tile/train/good/150.png', './data/mvtec/tile/train/good/186.png', './data/mvtec/tile/train/good/116.png']
2025-11-14 02:02:37,587 - INFO - Category tile: Sample_CLS_AUROC: 100.000000 Sample_CLS_AP: 100.000000 Sample_CLS_max-F1: 100.000000 Pixel_AUROC: 96.760566 Pixel_AP: 75.457230 Pixel_max-F1: 72.209489 Pixel_PRO: 93.875490 
2025-11-14 02:02:37,588 - INFO - wood, ['./data/mvtec/wood/train/good/207.png', './data/mvtec/wood/train/good/198.png', './data/mvtec/wood/train/good/112.png', './data/mvtec/wood/train/good/127.png']
2025-11-14 02:04:21,021 - INFO - Category wood: Sample_CLS_AUROC: 99.912281 Sample_CLS_AP: 99.972678 Sample_CLS_max-F1: 99.173554 Pixel_AUROC: 96.748560 Pixel_AP: 72.252486 Pixel_max-F1: 68.360880 Pixel_PRO: 96.459145 
2025-11-14 02:04:21,022 - INFO - bottle, ['./data/mvtec/bottle/train/good/064.png', './data/mvtec/bottle/train/good/138.png', './data/mvtec/bottle/train/good/045.png', './data/mvtec/bottle/train/good/094.png']
2025-11-14 02:06:10,224 - INFO - Category bottle: Sample_CLS_AUROC: 100.000000 Sample_CLS_AP: 100.000000 Sample_CLS_max-F1: 100.000000 Pixel_AUROC: 97.227195 Pixel_AP: 80.450359 Pixel_max-F1: 74.844709 Pixel_PRO: 94.195825 
2025-11-14 02:06:10,224 - INFO - cable, ['./data/mvtec/cable/train/good/194.png', './data/mvtec/cable/train/good/081.png', './data/mvtec/cable/train/good/059.png', './data/mvtec/cable/train/good/053.png']
2025-11-14 02:09:19,549 - INFO - Category cable: Sample_CLS_AUROC: 87.893553 Sample_CLS_AP: 92.636171 Sample_CLS_max-F1: 84.848485 Pixel_AUROC: 93.900462 Pixel_AP: 51.459561 Pixel_max-F1: 52.721979 Pixel_PRO: 87.890310 
2025-11-14 02:09:19,550 - INFO - capsule, ['./data/mvtec/capsule/train/good/130.png', './data/mvtec/capsule/train/good/044.png', './data/mvtec/capsule/train/good/210.png', './data/mvtec/capsule/train/good/143.png']
2025-11-14 02:11:58,481 - INFO - Category capsule: Sample_CLS_AUROC: 98.125249 Sample_CLS_AP: 99.630087 Sample_CLS_max-F1: 97.737557 Pixel_AUROC: 98.328745 Pixel_AP: 49.782885 Pixel_max-F1: 49.607262 Pixel_PRO: 97.301648 
2025-11-14 02:11:58,482 - INFO - hazelnut, ['./data/mvtec/hazelnut/train/good/210.png', './data/mvtec/hazelnut/train/good/361.png', './data/mvtec/hazelnut/train/good/031.png', './data/mvtec/hazelnut/train/good/118.png']
2025-11-14 02:14:17,386 - INFO - Category hazelnut: Sample_CLS_AUROC: 99.785714 Sample_CLS_AP: 99.874792 Sample_CLS_max-F1: 99.290780 Pixel_AUROC: 99.024666 Pixel_AP: 70.855629 Pixel_max-F1: 69.942393 Pixel_PRO: 97.465601 
2025-11-14 02:14:17,386 - INFO - metal_nut, ['./data/mvtec/metal_nut/train/good/187.png', './data/mvtec/metal_nut/train/good/047.png', './data/mvtec/metal_nut/train/good/049.png', './data/mvtec/metal_nut/train/good/069.png']
2025-11-14 02:17:06,464 - INFO - Category metal_nut: Sample_CLS_AUROC: 100.000000 Sample_CLS_AP: 100.000000 Sample_CLS_max-F1: 100.000000 Pixel_AUROC: 92.837703 Pixel_AP: 65.413632 Pixel_max-F1: 62.564961 Pixel_PRO: 92.501062 
2025-11-14 02:17:06,464 - INFO - pill, ['./data/mvtec/pill/train/good/034.png', './data/mvtec/pill/train/good/052.png', './data/mvtec/pill/train/good/246.png', './data/mvtec/pill/train/good/134.png']
2025-11-14 02:20:37,432 - INFO - Category pill: Sample_CLS_AUROC: 96.072013 Sample_CLS_AP: 99.252995 Sample_CLS_max-F1: 96.167247 Pixel_AUROC: 94.302169 Pixel_AP: 56.629138 Pixel_max-F1: 59.113397 Pixel_PRO: 96.784588 
2025-11-14 02:20:37,432 - INFO - screw, ['./data/mvtec/screw/train/good/297.png', './data/mvtec/screw/train/good/231.png', './data/mvtec/screw/train/good/163.png', './data/mvtec/screw/train/good/311.png']
2025-11-14 02:23:44,401 - INFO - Category screw: Sample_CLS_AUROC: 86.021726 Sample_CLS_AP: 94.140076 Sample_CLS_max-F1: 90.322581 Pixel_AUROC: 98.382375 Pixel_AP: 37.826780 Pixel_max-F1: 40.878539 Pixel_PRO: 93.725790 
2025-11-14 02:23:44,401 - INFO - toothbrush, ['./data/mvtec/toothbrush/train/good/028.png', './data/mvtec/toothbrush/train/good/030.png', './data/mvtec/toothbrush/train/good/039.png', './data/mvtec/toothbrush/train/good/020.png']
2025-11-14 02:24:36,684 - INFO - Category toothbrush: Sample_CLS_AUROC: 96.944444 Sample_CLS_AP: 98.778147 Sample_CLS_max-F1: 95.238095 Pixel_AUROC: 99.053320 Pixel_AP: 67.868744 Pixel_max-F1: 67.325341 Pixel_PRO: 94.406404 
2025-11-14 02:24:36,684 - INFO - transistor, ['./data/mvtec/transistor/train/good/036.png', './data/mvtec/transistor/train/good/168.png', './data/mvtec/transistor/train/good/053.png', './data/mvtec/transistor/train/good/069.png']
2025-11-14 02:26:47,579 - INFO - Category transistor: Sample_CLS_AUROC: 93.541667 Sample_CLS_AP: 92.817675 Sample_CLS_max-F1: 86.746988 Pixel_AUROC: 84.265823 Pixel_AP: 37.783559 Pixel_max-F1: 40.245219 Pixel_PRO: 68.049367 
2025-11-14 02:26:47,579 - INFO - zipper, ['./data/mvtec/zipper/train/good/191.png', './data/mvtec/zipper/train/good/083.png', './data/mvtec/zipper/train/good/045.png', './data/mvtec/zipper/train/good/134.png']
2025-11-14 02:29:50,996 - INFO - Category zipper: Sample_CLS_AUROC: 98.949580 Sample_CLS_AP: 99.718139 Sample_CLS_max-F1: 97.500000 Pixel_AUROC: 98.529277 Pixel_AP: 72.871351 Pixel_max-F1: 69.383961 Pixel_PRO: 95.116462 
2025-11-14 02:29:50,997 - INFO - Average: Sample_CLS_AUROC: 97.043928 Sample_CLS_AP: 98.418384 Sample_CLS_max-F1: 96.230257 Pixel_AUROC: 96.390934 Pixel_AP: 60.998034 Pixel_max-F1: 60.138956 Pixel_PRO: 93.159052 
2025-11-14 02:29:50,997 - INFO - --------------------------------------------------------------------
2025-11-14 02:29:50,997 - INFO - [Summary]
2025-11-14 02:29:50,997 - INFO - mvtec: value=Sample_CLS_AUROC: 97.043928 Sample_CLS_AP: 98.418384 Sample_CLS_max-F1: 96.230257 Pixel_AUROC: 96.390934 Pixel_AP: 60.998034 Pixel_max-F1: 60.138956 Pixel_PRO: 93.159052 
