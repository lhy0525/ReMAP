2025-11-14 17:31:55,048 - INFO - [Logger] writing to ./results/few_shot/4/run_4/test_results_20251114-173155.log
2025-11-14 17:31:55,049 - INFO - [Args] {'clip_download_dir': './download/clip/', 'data_dir': './data', 'dataset': 'visa', 'model': 'ViT-L/14@336px', 'batch_size': 8, 'img_size': 518, 'test_dataset': ['mvtec'], 'weight': './weight/best_maxf1_visa.pt', 'load_strict': False, 'device': 'cuda:0', 'prompt_len': 12, 'fewshot': 4, 'vis': 0, 'vis_dir': './vis', 'alpha': 0.1, 'memory_layers': [6, 12, 18, 24], 'adapter_layers': -1, 'result_dir': './results/few_shot/4/run_4', 'log_file': ''}
2025-11-14 17:31:55,397 - INFO - --------------------------- mvtec ---------------------------
2025-11-14 17:31:55,401 - INFO - carpet, ['./data/mvtec/carpet/train/good/181.png', './data/mvtec/carpet/train/good/104.png', './data/mvtec/carpet/train/good/009.png', './data/mvtec/carpet/train/good/259.png']
2025-11-14 17:34:20,097 - INFO - Category carpet: Sample_CLS_AUROC: 99.799358 Sample_CLS_AP: 99.936143 Sample_CLS_max-F1: 99.441341 Pixel_AUROC: 99.294791 Pixel_AP: 80.857317 Pixel_max-F1: 73.705098 Pixel_PRO: 97.558663 
2025-11-14 17:34:20,097 - INFO - grid, ['./data/mvtec/grid/train/good/193.png', './data/mvtec/grid/train/good/111.png', './data/mvtec/grid/train/good/049.png', './data/mvtec/grid/train/good/230.png']
2025-11-14 17:35:52,106 - INFO - Category grid: Sample_CLS_AUROC: 97.159566 Sample_CLS_AP: 99.077900 Sample_CLS_max-F1: 96.363636 Pixel_AUROC: 98.165896 Pixel_AP: 43.985086 Pixel_max-F1: 48.701355 Pixel_PRO: 94.437368 
2025-11-14 17:35:52,106 - INFO - leather, ['./data/mvtec/leather/train/good/100.png', './data/mvtec/leather/train/good/009.png', './data/mvtec/leather/train/good/191.png', './data/mvtec/leather/train/good/043.png']
2025-11-14 17:38:20,284 - INFO - Category leather: Sample_CLS_AUROC: 100.000000 Sample_CLS_AP: 100.000000 Sample_CLS_max-F1: 100.000000 Pixel_AUROC: 99.557156 Pixel_AP: 58.053485 Pixel_max-F1: 56.813097 Pixel_PRO: 99.002929 
2025-11-14 17:38:20,285 - INFO - tile, ['./data/mvtec/tile/train/good/089.png', './data/mvtec/tile/train/good/106.png', './data/mvtec/tile/train/good/021.png', './data/mvtec/tile/train/good/057.png']
2025-11-14 17:40:58,854 - INFO - Category tile: Sample_CLS_AUROC: 99.963925 Sample_CLS_AP: 99.985994 Sample_CLS_max-F1: 99.408284 Pixel_AUROC: 96.985253 Pixel_AP: 76.534969 Pixel_max-F1: 72.825516 Pixel_PRO: 94.194606 
2025-11-14 17:40:58,855 - INFO - wood, ['./data/mvtec/wood/train/good/055.png', './data/mvtec/wood/train/good/193.png', './data/mvtec/wood/train/good/049.png', './data/mvtec/wood/train/good/089.png']
2025-11-14 17:42:41,854 - INFO - Category wood: Sample_CLS_AUROC: 100.000000 Sample_CLS_AP: 100.000000 Sample_CLS_max-F1: 100.000000 Pixel_AUROC: 96.767421 Pixel_AP: 72.623065 Pixel_max-F1: 68.305586 Pixel_PRO: 96.593043 
2025-11-14 17:42:41,854 - INFO - bottle, ['./data/mvtec/bottle/train/good/027.png', './data/mvtec/bottle/train/good/029.png', './data/mvtec/bottle/train/good/172.png', './data/mvtec/bottle/train/good/179.png']
2025-11-14 17:44:30,361 - INFO - Category bottle: Sample_CLS_AUROC: 99.603175 Sample_CLS_AP: 99.871925 Sample_CLS_max-F1: 99.212598 Pixel_AUROC: 97.101232 Pixel_AP: 79.448486 Pixel_max-F1: 74.140353 Pixel_PRO: 94.283884 
2025-11-14 17:44:30,362 - INFO - cable, ['./data/mvtec/cable/train/good/126.png', './data/mvtec/cable/train/good/190.png', './data/mvtec/cable/train/good/104.png', './data/mvtec/cable/train/good/027.png']
2025-11-14 17:47:40,469 - INFO - Category cable: Sample_CLS_AUROC: 90.067466 Sample_CLS_AP: 93.825544 Sample_CLS_max-F1: 88.172043 Pixel_AUROC: 93.498217 Pixel_AP: 48.558646 Pixel_max-F1: 50.214147 Pixel_PRO: 87.394879 
2025-11-14 17:47:40,470 - INFO - capsule, ['./data/mvtec/capsule/train/good/072.png', './data/mvtec/capsule/train/good/085.png', './data/mvtec/capsule/train/good/015.png', './data/mvtec/capsule/train/good/178.png']
2025-11-14 17:50:21,653 - INFO - Category capsule: Sample_CLS_AUROC: 96.689270 Sample_CLS_AP: 99.339286 Sample_CLS_max-F1: 96.330275 Pixel_AUROC: 98.321207 Pixel_AP: 49.266728 Pixel_max-F1: 47.892579 Pixel_PRO: 97.727527 
2025-11-14 17:50:21,653 - INFO - hazelnut, ['./data/mvtec/hazelnut/train/good/185.png', './data/mvtec/hazelnut/train/good/098.png', './data/mvtec/hazelnut/train/good/369.png', './data/mvtec/hazelnut/train/good/224.png']
2025-11-14 17:52:40,570 - INFO - Category hazelnut: Sample_CLS_AUROC: 100.000000 Sample_CLS_AP: 100.000000 Sample_CLS_max-F1: 100.000000 Pixel_AUROC: 99.136055 Pixel_AP: 73.084186 Pixel_max-F1: 71.368422 Pixel_PRO: 97.504265 
2025-11-14 17:52:40,570 - INFO - metal_nut, ['./data/mvtec/metal_nut/train/good/123.png', './data/mvtec/metal_nut/train/good/012.png', './data/mvtec/metal_nut/train/good/043.png', './data/mvtec/metal_nut/train/good/140.png']
2025-11-14 17:55:30,483 - INFO - Category metal_nut: Sample_CLS_AUROC: 100.000000 Sample_CLS_AP: 100.000000 Sample_CLS_max-F1: 100.000000 Pixel_AUROC: 93.468932 Pixel_AP: 67.573055 Pixel_max-F1: 65.118031 Pixel_PRO: 93.038974 
2025-11-14 17:55:30,483 - INFO - pill, ['./data/mvtec/pill/train/good/154.png', './data/mvtec/pill/train/good/012.png', './data/mvtec/pill/train/good/172.png', './data/mvtec/pill/train/good/087.png']
2025-11-14 17:59:02,972 - INFO - Category pill: Sample_CLS_AUROC: 97.899618 Sample_CLS_AP: 99.604399 Sample_CLS_max-F1: 97.857143 Pixel_AUROC: 95.108593 Pixel_AP: 58.407533 Pixel_max-F1: 59.892011 Pixel_PRO: 97.287047 
2025-11-14 17:59:02,972 - INFO - screw, ['./data/mvtec/screw/train/good/226.png', './data/mvtec/screw/train/good/317.png', './data/mvtec/screw/train/good/084.png', './data/mvtec/screw/train/good/248.png']
2025-11-14 18:02:16,837 - INFO - Category screw: Sample_CLS_AUROC: 78.725149 Sample_CLS_AP: 91.345742 Sample_CLS_max-F1: 88.549618 Pixel_AUROC: 97.854546 Pixel_AP: 24.431094 Pixel_max-F1: 29.584016 Pixel_PRO: 92.043382 
2025-11-14 18:02:16,837 - INFO - toothbrush, ['./data/mvtec/toothbrush/train/good/010.png', './data/mvtec/toothbrush/train/good/007.png', './data/mvtec/toothbrush/train/good/044.png', './data/mvtec/toothbrush/train/good/038.png']
2025-11-14 18:03:06,504 - INFO - Category toothbrush: Sample_CLS_AUROC: 98.888889 Sample_CLS_AP: 99.576613 Sample_CLS_max-F1: 96.774194 Pixel_AUROC: 99.459289 Pixel_AP: 71.849155 Pixel_max-F1: 71.253986 Pixel_PRO: 96.691984 
2025-11-14 18:03:06,505 - INFO - transistor, ['./data/mvtec/transistor/train/good/102.png', './data/mvtec/transistor/train/good/124.png', './data/mvtec/transistor/train/good/041.png', './data/mvtec/transistor/train/good/055.png']
2025-11-14 18:05:20,855 - INFO - Category transistor: Sample_CLS_AUROC: 90.750000 Sample_CLS_AP: 90.111341 Sample_CLS_max-F1: 87.500000 Pixel_AUROC: 82.908115 Pixel_AP: 33.401509 Pixel_max-F1: 34.792180 Pixel_PRO: 66.109775 
2025-11-14 18:05:20,856 - INFO - zipper, ['./data/mvtec/zipper/train/good/224.png', './data/mvtec/zipper/train/good/049.png', './data/mvtec/zipper/train/good/041.png', './data/mvtec/zipper/train/good/175.png']
2025-11-14 18:08:27,715 - INFO - Category zipper: Sample_CLS_AUROC: 99.737395 Sample_CLS_AP: 99.931442 Sample_CLS_max-F1: 98.734177 Pixel_AUROC: 98.595844 Pixel_AP: 73.260313 Pixel_max-F1: 69.503211 Pixel_PRO: 95.428139 
2025-11-14 18:08:27,716 - INFO - Average: Sample_CLS_AUROC: 96.618921 Sample_CLS_AP: 98.173755 Sample_CLS_max-F1: 96.556221 Pixel_AUROC: 96.414836 Pixel_AP: 60.755642 Pixel_max-F1: 59.607306 Pixel_PRO: 93.286431 
2025-11-14 18:08:27,716 - INFO - --------------------------------------------------------------------
2025-11-14 18:08:27,716 - INFO - [Summary]
2025-11-14 18:08:27,716 - INFO - mvtec: value=Sample_CLS_AUROC: 96.618921 Sample_CLS_AP: 98.173755 Sample_CLS_max-F1: 96.556221 Pixel_AUROC: 96.414836 Pixel_AP: 60.755642 Pixel_max-F1: 59.607306 Pixel_PRO: 93.286431 
